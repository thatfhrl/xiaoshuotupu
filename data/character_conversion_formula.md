# 小说角色关系转换指南

本文档提供将小说人物描述文本转换为结构化JSON格式的方法，适用于构建人物关系可视化数据。

## 1. 基本结构

最终的JSON文件包含两个主要部分：
- `characters`: 人物基本信息数组
- `relationships`: 人物间关系数组

```json
{
  "characters": [ ... ],
  "relationships": [ ... ]
}
```

## 2. 人物信息提取

从文本中提取人物信息时，遵循以下步骤：

1. 找出主要人物段落（通常是段落开头是人名的部分）
2. 为每个人物创建唯一ID（使用拼音小写，下划线分隔）
3. 提取人物名称
4. 提取简短描述（通常是第一句话，控制在100-150字以内）
5. 设置默认头像和视频路径

### 人物结构

```json
{
  "id": "拼音名称（小写，下划线分隔）",
  "name": "中文名称",
  "avatar": "assets/images/拼音名称.jpg",
  "description": "简短描述",
  "videoUrl": "assets/videos/拼音名称.mp4"
}
```

## 3. 关系信息提取

分析文本中的人物关系描述：

1. 识别主要人物之间的关系类型
2. 为每对有关系的人物创建关系条目
3. 根据关系性质确定关系类型

### 关系结构

```json
{
  "source": "来源人物ID",
  "target": "目标人物ID",
  "type": "关系类型"
}
```

### 关系类型

标准关系类型包括：
- `connected`: 一般联系/认识
- `master_disciple`: 师徒关系
- `family`: 家族/亲属关系
- `friend`: 朋友关系
- `fiance`: 婚约/伴侣关系
- `same_race`: 同族/同类关系

## 4. 转换实例

### 原文本示例
```
方羽：本作主角，五千年前就存活于世的人族修士，人族大统继承者。拥有强大至极的实力...
林霸天：方羽的好友，与冷寻双亦是故交，玄门弟子，号"霸天圣尊"。两千年前渡劫飞升...
```

### JSON转换结果
```json
{
  "characters": [
    {
      "id": "fang_yu",
      "name": "方羽",
      "avatar": "assets/images/fangyu.jpg",
      "description": "本作主角，五千年前就存活于世的人族修士，人族大统继承者。拥有强大至极的实力...",
      "videoUrl": "assets/videos/fangyu.mp4"
    },
    {
      "id": "lin_batian",
      "name": "林霸天",
      "avatar": "assets/images/linbatian.jpg",
      "description": "方羽的好友，与冷寻双亦是故交，玄门弟子，号"霸天圣尊"。两千年前渡劫飞升...",
      "videoUrl": "assets/videos/linbatian.mp4"
    }
  ],
  "relationships": [
    {
      "source": "fang_yu",
      "target": "lin_batian",
      "type": "friend"
    }
  ]
}
```

## 5. 自动化转换步骤

1. **预处理文本**：将原始文本按人物分段，移除不必要的符号和格式
2. **创建人物词典**：将人物名称与ID的映射存储在字典中
3. **提取人物信息**：为每个人物创建对应的JSON对象
4. **分析关系描述**：从文本中提取描述关系的关键词和短语
5. **构建关系数组**：根据关系描述创建关系对象
6. **合并输出**：将人物信息和关系信息合并为完整的JSON文件

## 6. 关系识别规则

从文本中识别关系时，可以使用以下关键词匹配：

- **师徒关系**：包含"师父"、"师傅"、"弟子"、"徒弟"、"师尊"等词汇
- **朋友关系**：包含"朋友"、"好友"、"故交"等词汇
- **家族关系**：包含"父亲"、"母亲"、"兄弟"、"姐妹"、"家族"等词汇
- **婚约关系**：包含"道侣"、"伴侣"、"夫妻"、"婚约"等词汇
- **同族关系**：包含"同族"、"同类"、"一族"等词汇
- **一般联系**：当无法确定具体关系类型时使用

## 7. 注意事项

1. 保持描述简洁明了，避免过长的文本
2. 确保所有ID唯一且遵循命名规范
3. 人物之间可能存在多种关系，选择最主要的关系类型
4. 所有路径保持一致的命名规范
5. 确保最终的JSON格式正确，没有语法错误

通过遵循上述指南，可以有效地将小说文本中的人物关系转换为结构化的JSON格式，为可视化和分析提供基础。
